<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>The GraphIt Programming Language</title>
    
    <link rel="stylesheet" href="stylesheets/styles.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <link rel="stylesheet" href="stylesheets/prism.css" />
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-40269412-1']);
      _gaq.push(['_setDomainName', 'simit-lang.org']);
      _gaq.push(['_setAllowLinker', true]);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
  </head>
  <body>
    <div class="wrapper">
      <header>
        <a href="index"><h1 class="title"> GraphIt</h1></a>
        <p>A high-performance graph domain specific language</p>
        <ul>
          <li><a href="http://github.com/yunmingzhang17/graphit">View On <strong>GitHub</strong></a></li>
        </ul>
        <p><a href="getting-started">Getting Started</a></p>
        <p><a href="language">Language Manual</a></p>
        <p><a href="publications">Publications</a></p>
	<p><a href="user-group">User Group</a></p>
      </header>
      <footer>
        <p><a href="https://yunmingzhang.wordpress.com/">Yunming Zhang</a> <br>yunming at mit dot edu</p>
        <p><small>Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
      <section class="language-graphit">
      <h1 class="no_toc" id="the-graphit-programming-language">The GraphIt Programming Language</h1>

<p>This guide introduces GraphIt language features and shows how they can be used in
programs.</p>

<ul id="markdown-toc">
  <li><a href="#basics" id="markdown-toc-basics">Basics</a>    <ul>
      <li><a href="#functions" id="markdown-toc-functions">Functions</a></li>
      <li><a href="#variables" id="markdown-toc-variables">Variables</a></li>
      <li><a href="#comments" id="markdown-toc-comments">Comments</a></li>
    </ul>
  </li>
  <li><a href="#control-flow-statements" id="markdown-toc-control-flow-statements">Control Flow Statements</a>    <ul>
      <li><a href="#if-statements" id="markdown-toc-if-statements">If Statements</a></li>
      <li><a href="#while-loops" id="markdown-toc-while-loops">While Loops</a></li>
      <li><a href="#for-loops" id="markdown-toc-for-loops">For Loops</a></li>
    </ul>
  </li>
  <li><a href="#elements-vectors-vertexsets-edgesets" id="markdown-toc-elements-vectors-vertexsets-edgesets">Elements, Vectors, VertexSets, EdgeSets</a>    <ul>
      <li><a href="#elements" id="markdown-toc-elements">Elements</a></li>
      <li><a href="#vectors" id="markdown-toc-vectors">Vectors</a></li>
      <li><a href="#edgesets" id="markdown-toc-edgesets">Edgesets</a></li>
      <li><a href="#vertexsets" id="markdown-toc-vertexsets">Vertexsets</a></li>
    </ul>
  </li>
  <li><a href="#set-opeartors" id="markdown-toc-set-opeartors">Set Opeartors</a>    <ul>
      <li><a href="#edgeset-operators" id="markdown-toc-edgeset-operators">Edgeset Operators</a>        <ul>
          <li><a href="#from-to-and-filter" id="markdown-toc-from-to-and-filter">from, to and filter</a></li>
          <li><a href="#srcfilter-and-dstfilter" id="markdown-toc-srcfilter-and-dstfilter">srcFilter and dstFilter</a></li>
          <li><a href="#apply" id="markdown-toc-apply">apply</a></li>
          <li><a href="#applymodified" id="markdown-toc-applymodified">applyModified</a></li>
          <li><a href="#combining-edgeset-operators" id="markdown-toc-combining-edgeset-operators">combining edgeset operators</a></li>
        </ul>
      </li>
      <li><a href="#vertexset-operators" id="markdown-toc-vertexset-operators">Vertexset Operators</a>        <ul>
          <li><a href="#filter" id="markdown-toc-filter">filter</a></li>
          <li><a href="#apply-1" id="markdown-toc-apply-1">apply</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#scheduling-language" id="markdown-toc-scheduling-language">Scheduling Language</a></li>
</ul>

<h1 id="basics">Basics</h1>
<p>GraphIt is an imperative language with statements, control flow, and high-level operators on sts of vertices ane edges. In this section, we describe some of the language’s basic constructs.</p>

<h2 id="functions">Functions</h2>
<p>Functions can take any number of parameters, including none. Each parameter
must be declared with its name followed by its type (separated by a <code class="highlighter-rouge">:</code>). In
the following example, the function <code class="highlighter-rouge">add</code> takes two parameters named <code class="highlighter-rouge">a</code> and
<code class="highlighter-rouge">b</code>, both of which are of type <code class="highlighter-rouge">float</code>, and returns a single result (named <code class="highlighter-rouge">c</code>)
that is also a <code class="highlighter-rouge">float</code>. The function result is separated from the list of
parameters by a <code class="highlighter-rouge">-&gt;</code> and the function declaration is delimited by the <code class="highlighter-rouge">end</code>
keyword.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>func add(a : float, b : float) -&gt; c : float
  c = a + b;
end
</code></pre></div></div>

<p>Like functions in MATLAB, GraphIt functions can return any number of results,
including none. In the next example, the function <code class="highlighter-rouge">minMax</code> takes two <code class="highlighter-rouge">float</code>
parameters and return two <code class="highlighter-rouge">float</code> results: the smaller of the two inputs as the
first result and the larger of the two inputs as the second result.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>func minMax(a : float, b : float) 
    -&gt; (c : float, d : float)
  if a &lt; b
    c = a;
    d = b;
  else
    c = b;
    d = a;
  end
end
</code></pre></div></div>

<p>Note that the list of function results must be surrounded by parentheses if the
function returns more than one result. (The parentheses are optional if the
function returns just a single result.)</p>

<h2 id="variables">Variables</h2>
<p>Variables are declared in function bodies or in the global scope using the
<code class="highlighter-rouge">var</code> keyword. The following example declares an integer variable named <code class="highlighter-rouge">foo</code>:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>var foo : int;
</code></pre></div></div>

<p>If the variable declaration has an initializer, then the variable’s type can be
inferred from the initializer value. The following are equivalent ways to
define a floating-point variable that is initialized to <code class="highlighter-rouge">0.0</code>:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>var foo : float = 0.0;
var foo = 0.0;
</code></pre></div></div>

<p>The <code class="highlighter-rouge">const</code> keyword creates a variable that cannot be modified after
initialization.  The following example shows three ways to declare constant
variables that are initialized to <code class="highlighter-rouge">0.0</code>:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>const foo = 0.0;
const bar = foo;
bazz = 0.0;
</code></pre></div></div>

<p>Individual elements of const vectors can still be updated.</p>

<h2 id="comments">Comments</h2>
<p>Single-line comments start with <code class="highlighter-rouge">%</code>:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>h = 0.01;  % h is the time-step size.
</code></pre></div></div>

<p>Multi-line comments are surrounded by <code class="highlighter-rouge">%{</code> and <code class="highlighter-rouge">%}</code>:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>%{
h is the time-step size.
h is initialized to one millisecond.
%}
h = 0.001;
</code></pre></div></div>

<h1 id="control-flow-statements">Control Flow Statements</h1>
<p>GraphIt supports a variety of control flow constructs, including <code class="highlighter-rouge">if</code> statements,
<code class="highlighter-rouge">while</code> loops, <code class="highlighter-rouge">do</code>-<code class="highlighter-rouge">while</code> loops and <code class="highlighter-rouge">for</code> loops.</p>

<h2 id="if-statements">If Statements</h2>

<p>In GraphIt, a simple <code class="highlighter-rouge">if</code> statement looks something like this:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>if x &lt; 1
  print "x is less than 1";
end
</code></pre></div></div>

<p>An <code class="highlighter-rouge">if</code> statement can optionally include an <code class="highlighter-rouge">else</code> clause as well as an any
number of <code class="highlighter-rouge">elif</code> (else-if) clauses:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>if x &lt; 1
  print "x is less than 1";
elif x &gt; 5
  print "x is greater than 5";
else
  print "x is between 1 and 5";
end
</code></pre></div></div>

<h2 id="while-loops">While Loops</h2>

<p>A <code class="highlighter-rouge">while</code> loop in GraphIt looks like this:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>while x &lt; 100
  x = 2 * x;
end
</code></pre></div></div>

<p>As with <code class="highlighter-rouge">if</code> statements, logical operators and comparison operators can be used
to construct more complex conditions. Note that if the condition of a <code class="highlighter-rouge">while</code>
loop is false when a GraphIt program first encounters the loop, the loop body
will not be executed at all.</p>

<h2 id="for-loops">For Loops</h2>

<p>GraphIt <code class="highlighter-rouge">for</code> loops are more like those found in MATLAB, Julia and Python than
those available in C. You can use a <code class="highlighter-rouge">for</code> loop to iterate over the set of all integers between two values, as shown in the following example.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>for i in 0:10
  print i;
end
</code></pre></div></div>

<p>Note that the lower bound is <em>inclusive</em> while the upper bound is <em>exclusive</em>
(like Python), so the above example prints all integers between 0 and 9 but
omits 10.</p>

<h1 id="elements-vectors-vertexsets-edgesets">Elements, Vectors, VertexSets, EdgeSets</h1>
<p>Elements, vertexsets, edgesets and vectors form GraphIt’s <em>data model</em>.</p>

<h2 id="elements">Elements</h2>
<p>An element is a type that stores one or more data fields, much like a struct in
C/C++. For example, a vertex in a social network representing a person can have a Person Element type. In the future, we plan to support fields in the Element. Currently, fields associated with an Element are expressed as separate Vectors descrived below.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>element Person
end
</code></pre></div></div>

<h2 id="vectors">Vectors</h2>

<p>Vectors are associated with an element. Essentially they act as fields of the elements. The following code says that <code class="highlighter-rouge">age</code> is a vector for <code class="highlighter-rouge">Person</code> Element type. Each Person would have an associated age field, and the field is initialized to 0.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>const age : vector {Person}(int) = 0;

</code></pre></div></div>

<h2 id="edgesets">Edgesets</h2>
<p>Edgesets are have connectivity information. In particular, edge
set definitions specify the type of elements from which each edge’s endpoints come.
The following declares a set of spring elements that each connect two points
from the <code class="highlighter-rouge">edges</code> set:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>const edges : edgeset{Follow}(Person,Person);
</code></pre></div></div>

<p>There is no explicit graph type in GraphIt; rather, graphs are formed implicitly
from the edgesets. This is similar to how graphs are
often defined in mathematical papers (i.e. as an ordered pair <code class="highlighter-rouge">G = (V,E)</code>).</p>

<h2 id="vertexsets">Vertexsets</h2>

<p>Vertexsets are sets of vertices of a specific Element Type. <code class="highlighter-rouge">people</code> is a vertexset made up of endpoint elements of Person Type from the <code class="highlighter-rouge">edges</code> edgeset.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>const people : vertexset{Person} = edges.getVertices();

</code></pre></div></div>

<h1 id="set-opeartors">Set Opeartors</h1>
<h2 id="edgeset-operators">Edgeset Operators</h2>

<h3 id="from-to-and-filter">from, to and filter</h3>
<p><code class="highlighter-rouge">from</code> and <code class="highlighter-rouge">to</code> Filters out edges whose source vertex is in the input set.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>const people_age_over_40 : vertexset{Person} = ... 
const people_age_over_60 : vertexset{Person} = ...

func main()
  ...
  % find edges between people over 40 years old to people over 60 years old
  var filtered_edges : edgeset{Friend}(Person, Person} = 
       friend_edges.from(people_age_over_40).to(people_age_over_60);
end 

</code></pre></div></div>

<p><code class="highlighter-rouge">filter</code> simply supplies a boolean function that checks every edge.</p>

<h3 id="srcfilter-and-dstfilter">srcFilter and dstFilter</h3>

<p><code class="highlighter-rouge">srcFilter</code> and <code class="highlighter-rouge">dstFilter</code> filters out edges where the input boolean filtering function <code class="highlighter-rouge">filter_func</code> returns true.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>func filter_func(v : Vertex) -&gt; output : bool
    output =  age[v] &gt; 40;
end

func main()
  ...
  filtered_edges = edges.srcFilter(filter_func);
  ...
end

</code></pre></div></div>

<h3 id="apply">apply</h3>

<p>This operator applies a function <code class="highlighter-rouge">updateEdge </code> to every edge. In one iteration of PageRank,</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>func updateEdge(src : Vertex, dst : Vertex)
    new_rank[dst] += contrib[src];
end

func main()
  ...
  edges.apply(updateEdge);
  ...
end
</code></pre></div></div>

<h3 id="applymodified">applyModified</h3>
<p>This operator applies a function (<code class="highlighter-rouge">updateEdge</code>) to every edge. Returns a vertexset that contains destination vertices whose entry in the vector has been modified in <code class="highlighter-rouge">updateEdge</code>. The programmer can optionally disable deduplication within modfieid vertices. Deduplication is enabled by default.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>func updateEdge(src : Vertex, dst : Vertex)
    parent[dst] = src;
end

func main()
  ...
  edges.applyModified(updateEdge,parent, true);
  ...
end

</code></pre></div></div>

<h3 id="combining-edgeset-operators">combining edgeset operators</h3>

<p>The various operators can be and often are chained together.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>frontier = edges.from(frontier).to(toFilter).applyModified(updateEdge,parent, true);

</code></pre></div></div>

<h2 id="vertexset-operators">Vertexset Operators</h2>

<h3 id="filter">filter</h3>
<p>The filter operator is similar to the edgeset filter, except for it is applied on a single vertex and not edge.</p>

<h3 id="apply-1">apply</h3>
<p>The apply operator is similar to the edgeset apply operator, but applied to a vertex.</p>

<h1 id="scheduling-language">Scheduling Language</h1>

<p>For now, we refer users to the Section 5 of the <a href="https://arxiv.org/abs/1805.00923">arxiv report</a> on how to use the scheduling language.</p>

      </section>
    </div>
    <script src="javascripts/scale.fix.js"></script>
    <script src="javascripts/prism.js"></script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-79370201-1', 'auto');
      ga('send', 'pageview');

    </script>
  </body>
</html>
